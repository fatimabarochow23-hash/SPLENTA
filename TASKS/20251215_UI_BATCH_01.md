# Batch 01 — THEME 外部变更同步（Automation/State Restore）+ 主题应用只在变化时更新

## 背景
当前 updateColors() 只在构造时与点击 ThemeSelector 时触发。
paint() 虽然每帧读取 THEME 并画背景，但 sliders/buttons/envelope/themeSelector 的颜色/选中态不会在“宿主自动化/加载工程恢复状态”时自动同步。

## 目标
1) 当 THEME 参数被宿主自动化或状态恢复改变时：
- ThemeSelector 选中态自动更新
- EnvelopeView 主题色自动更新
- 所有 slider/button 使用的新主题色自动更新

2) 保持最小改动：不重构布局、不引入新依赖、不输出整文件。

## 实施要求（给 Claude）
### A. 在 Editor 内做“主题变化侦测”（复用现有 Timer）
- NewProjectAudioProcessorEditor 增加成员：lastThemeIndex（初始为 -1）
- 增加一个小工具函数：从 apvts 读取 THEME，做 roundToInt，并 jlimit 到 [0..4]
- 在 timerCallback() 开头读取 themeIndex
  - 若 themeIndex != lastThemeIndex：
    - lastThemeIndex = themeIndex
    - 调用 updateColors()
（updateColors 内已包含 themeSelector.setSelectedIndex(themeIndex)）

### B. updateColors() 只做“themeIndex -> palette -> 分发”
- 继续使用 ThemePalette::getPaletteByIndex(themeIndex)
- 不要在多个地方重复 switch/if 计算颜色
- 保持现有 UI 效果与布局不变

### C. 可选小优化（不强制）
- ThemeSelector onThemeChanged 里可以移除多余 repaint()，避免重复刷新

## 验收
- [ ] 不点击色球，仅通过宿主自动化改变 THEME：ThemeSelector/EnvelopeView/所有旋钮按钮颜色都会变
- [ ] 加载工程/恢复状态后：ThemeSelector 选中正确
- [ ] updateColors() 不会在每帧执行，只在主题变化时执行
- [ ] 不输出整文件，只输出改动摘要+关键片段+修改文件列表
