# SPLENTA UI Polish Batch 05.5: Visual Alignment & Theme Backgrounds

你是 JUCE UI 优化专家。用户反馈当前 UI 移植存在“布局拥挤”、“背景色未随主题切换”、“Visualizer 背景丑陋”等问题。我们需要进行一次视觉校准（Polish）。

---

## 任务 1：全域背景色同步 (Theme-Aware Backgrounds)

**问题**：当前 C++ 版本切换主题时，只有 Accent Color（高光）变了，背景依然是默认的棕黑色（Bronze），导致 Blue/Purple 主题看起来非常奇怪（蓝光配棕底）。
**目标**：引入 `backgroundColor` 到主题系统，并更新 `PluginEditor` 绘制逻辑。

**Web 版颜色映射 (HEX -> JUCE Colour):**
请在 `ThemePalette` 结构体中增加 `background` 字段，并配置如下颜色：
1.  **Bronze**: `0xFF140C08` (Warm Dark Brown)
2.  **Blue**: `0xFF020617` (Deep Dark Slate)
3.  **Purple**: `0xFF0F0518` (Deep Dark Violet)
4.  **Green**: `0xFF021205` (Deep Dark Green)
5.  **Pink**: `0xFF1F0510` (Deep Dark Maroon)

**执行动作**：
1.  修改 `Theme.h` (或相关定义文件)，为每种预设添加对应的背景色。
2.  修改 `PluginEditor.cpp` 的 `paint` 方法，将 `g.fillAll(...)` 的颜色源改为 `currentPalette.background`。
3.  确保 `Panel` 的背景色依然是 `Colours::white.withAlpha(0.03f)`，这样它能透出底部的深色背景。

---

## 任务 2：Energy Topology 背景优化 (Glow vs Ellipse)

**问题**：本地版 Visualizer 背景画了一个实心的椭圆，用户觉得很丑。Web 版使用的是 CSS `radial-gradient` 制作的柔和光晕。
**目标**：移除椭圆，实现径向渐变光晕。

**输入参考 (Web):**
```tsx
background: `radial-gradient(circle, ${accentColor}20 0%, transparent 70%)`
```

**执行动作**：
1.  打开 `MobiusVisualizerComponent.cpp`。
2.  找到 `paint` 方法中绘制背景椭圆（`g.fillEllipse`）的代码，**删除它**。
3.  替换为 `juce::ColourGradient::horizontal` (或 radial 模拟)。
    - 由于 JUCE 绘制真实的 RadialGradient 有时较重，可以使用一个大尺寸的图片画笔，或者简化的径向填充。
    - **推荐方案**：
      ```cpp
      g.setGradientFill(ColourGradient(
          accentColor.withAlpha(0.2f), bounds.getCentreX(), bounds.getCentreY(),
          Colours::transparentBlack, bounds.getCentreX(), bounds.getCentreY() + bounds.getHeight()/1.5f,
          true)); // true = radial
      g.fillAll();
      ```

---

## 任务 3：布局与拥挤度优化 (Layout De-crowding)

**问题**：下方控件区域（Control Panel）文字和旋钮重叠，显得拥挤。
**目标**：增加垂直间距，优化文字排版。

**执行动作**：
1.  打开负责下方控件布局的文件（可能是 `PluginEditor.cpp` 或独立的 `ControlsComponent`）。
2.  **增加行间距**：如果使用 `FlexBox` 或 Grid，增加 `rowGap`。如果是手动计算坐标，增加 Y 轴间距。
3.  **调整文字位置**：检查 `Knob` 组件的 `Label` 绘制位置。确保 Label 在旋钮下方有足够的 `margin`，或者旋钮缩小一点点（例如从 64px 减到 58px）以腾出空间。

---

## 任务 4：示波器参考线统一 (Standardize Lines)

**问题**：用户要求统一示波器（Oscilloscope/Detector）的参考线样式。
**目标**：
- **Ceiling 线**: 实线，红色 (`0xFFFF4444`)。
- **Threshold 线**: 虚线，白色 (`0xFFFFFFFF`)。

**执行动作**：
1.  打开 `OscilloscopeComponent.cpp` (或类似文件)。
2.  在 `paint` 方法中：
    - 绘制 Ceiling 线时，强制使用红色，忽略主题色。
    - 绘制 Threshold 线时，强制使用白色，并设置 `LineStyle` 为虚线 (`dashLengths = {4, 4}`)。

---

## 检查清单
- [ ] 切换到 Blue 主题时，整个插件背景是否变成了深蓝色？
- [ ] Topology 背景是否变成了柔和的光晕，而不是硬边的椭圆？
- [ ] 示波器的 Ceiling 线是红色的吗？Threshold 是白色虚线吗？
- [ ] 下方旋钮的标签文字是否不再遮挡旋钮本体？
